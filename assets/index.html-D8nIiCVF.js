import{_ as s,c as i,e as a,o as t}from"./app-DUgIjcn9.js";const n={};function l(o,e){return t(),i("div",null,e[0]||(e[0]=[a(`<h2 id="my-gentoo-linux-upgrade-guide" tabindex="-1"><a class="header-anchor" href="#my-gentoo-linux-upgrade-guide"><span>My Gentoo Linux Upgrade Guide</span></a></h2><ul><li>This Guide include two part, part one is package update, second part is kernel upgrade.</li><li>Part one is suit for any Gentoo Linux machine, but part two is customize version (We will customize kernel parameter and compile it by us manually!) is unfotanly need dracut for initramfs generate and systemboot for bootloader.If not, well, some command need to be chagne, but the general flow is same.</li><li>This is temperary for my PERSONAL REFRENCE ONLY, if you are newbee with Gentoo please read offical gentoo linux documentation first, this is for experianced user to refrence and optmize they update process.</li><li>Here is 2 offical guide you must read if you want to manage your Gentoo Linux: <ol><li><a href="https://wiki.gentoo.org/wiki/Portage" target="_blank" rel="noopener noreferrer">Portage Guide, about package management</a></li><li><a href="https://wiki.gentoo.org/wiki/Kernel" target="_blank" rel="noopener noreferrer">https://wiki.gentoo.org/wiki/Kernel, about kernel upgrade</a></li></ol></li></ul><h2 id="part-one-package-update" tabindex="-1"><a class="header-anchor" href="#part-one-package-update"><span>Part One Package Update</span></a></h2><h3 id="sync-with-repository" tabindex="-1"><a class="header-anchor" href="#sync-with-repository"><span>sync with repository</span></a></h3><ol><li>If you want to update all package for Gentoo Linux, first for all, you need sync all repository with upstream. there are two way to do this, first is fastest way --- download entire ebuild repository by using command:</li></ol><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">emerge-webrsync</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>This is the way i recommand, just like other Linux distrobution, fast and easy.</p><ol start="2"><li>Use old-school &#39;--sync&#39; subcommand to sync with repository per package, this will cost lots of time if you install lots of package on your machine,but you get more control to this process. Here is section of offical doc for it: --sync Updates repositories, for which auto-sync, sync-type and sync-uri attributes are set in repos.conf. A list of repos or aliases can be specified, in which case they will be updated regardless of their auto-sync attribute. See portage(5) for more information. The PORTAGE_SYNC_STALE variable configures warnings that are shown when emerge --sync has not been executed recently.</li></ol><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">emerge</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --sync</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="update-package" tabindex="-1"><a class="header-anchor" href="#update-package"><span>update package</span></a></h3><p>After secusessful sync with repository, you able to update all packages! This is a long-long process if you don&#39;t have a super computer. So, with PC, i recommand to start update package before bedtime (Zzz) This is the command i recommand:</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">emworld</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">  (alias </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">emworld=doas</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> emerge</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -avuDN</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> @world</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>I use a alias shortcut for it, in columns, there is full command. And commad meaning:</p><ol><li><p>-a :<br> Before performing the action, display what will take place (server info for --sync, --pretend output for merge, and so forth), then ask whether to proceed with the action or abort. Using --ask is more efficient than using --pretend and then executing the same command without --pretend, as dependencies will only need to be calculated once. &gt; [!warning] &gt;WARNING: If the &quot;Enter&quot; key is pressed at the prompt (with noother input), it is interpreted as acceptance of the first choice. &gt; Note that the input buffer is not cleared prior to the prompt, so an accidental press of the &quot;Enter&quot; key at any time prior to the prompt will be interpreted as a choice!</p></li><li><p>-v: Tell emerge to run in verbose mode. Currently this flag causes emerge to print out GNU info errors, if any, and to show the USE flags that will be used for each package when pretending. The following sym‐ bols are affixed to USE flags in order to indicate their status:</p><pre><code>     Symbol   Location    Meaning
     ──────────────────────────────────────────────────────────────

     -        prefix      not enabled (either disabled or removed)
     *        suffix      transition to or from the enabled state
     %        suffix      newly added or removed
     ()       circumfix   forced, masked, or removed
     {}       circumfix   state is bound to FEATURES settings
</code></pre></li><li><p>-u:<br> Updates packages to the best version available, which may not always be the highest version number due to masking for testing and development. Package atoms specified on the command line are greedy, meaning that unspecific atoms may match multiple versions of slotted packages. This option also implies the --selective option.</p></li><li><p>@world: excute behavior with all packages.</p></li></ol><p>Run the command, and read the output by section.</p><ul><li>Fist section is ebuild caculation part, it will automatic compare old and new synced version of package, list out packages gonna <em>new/update/reinstall/uninstall</em></li></ul><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ebuild     U  </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> sys-libs/glibc-2.41-r4:2.2::gentoo </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">2.40-r8:2.2::gentoo</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> USE</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">cet multiarch (multilib) ssp stack-realign (static-libs) -audit -caps -compile-locales (-custom-cflags) -doc -gd -hash-sysv-compat -headers-only -multilib-bootstrap -nscd -perl -profile (-selinux) -suid -systemd -systemtap -test (-vanilla)</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> 18,974</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> KiB</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ebuild     U  </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> sys-libs/ncurses-6.5_p20250329:0/6::gentoo </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">6.5_p20250125:0/6::gentoo</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> USE</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">cxx stack-realign (tinfo) -ada -debug -doc -gpm -minimal -profile (-split-usr) -static-libs -test -trace -verify-sig</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> ABI_X86</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">32 (64) (-x32)</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> 373</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> KiB</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Second section is conflict warning part</li></ul><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span></span></span>
<span class="line"><span>WARNING: One or more updates/rebuilds have been skipped due to a dependency conflict:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>dev-libs/icu:0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  (dev-libs/icu-77.1:0/77::gentoo, ebuild scheduled for merge) USE=&quot;-debug -doc -examples -static-libs -test -verify-sig&quot; ABI_X86=&quot;32 (64) (-x32)&quot; conflicts with</span></span>
<span class="line"><span>    dev-libs/icu:0/76=[abi_x86_64(-)] required by (dev-libs/boost-1.85.0-r1:0/1.85.0.1::gentoo, installed) USE=&quot;bzip2 context icu nls stacktrace zlib -debug -doc -lzma -mpi -numpy -python -tools -zstd&quot; ABI_X86=&quot;(64) -32 (-x32)&quot; PYTHON_TARGETS=&quot;python3_12 -python3_10 -python3_11 -python3_13&quot;</span></span>
<span class="line"><span>                ^^^^^^               </span></span>
<span class="line"><span></span></span>
<span class="line"><span>dev-libs/boost:0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  (dev-libs/boost-1.88.0-r1:0/1.88.0::gentoo, ebuild scheduled for merge) USE=&quot;bzip2 context icu nls stacktrace zlib -debug -doc -lzma -mpi -numpy -python -test -test-full -tools -zstd&quot; ABI_X86=&quot;(64) -32 (-x32)&quot; PYTHON_TARGETS=&quot;python3_13 -python3_11 -python3_12&quot; conflicts with</span></span>
<span class="line"><span>    &lt;dev-libs/boost-1.87:=[nls] required by (net-p2p/monero-0.18.3.4-r1:0/0::guru, ebuild scheduled for merge) USE=&quot;daemon readline tools wallet-cli wallet-rpc -hw-wallet&quot; ABI_X86=&quot;(64)&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Read it all and makesure nothing gona breake your system.</p><ul><li>Final part is rebuild list</li></ul><div class="language-haskell line-numbers-mode" data-ext="haskell" data-title="haskell"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>The following packages are causing rebuilds:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  (net-libs/miniupnpc-2.3.3-r1:0/21::gentoo, ebuild scheduled for merge) causes rebuilds for:</span></span>
<span class="line"><span>    (net-p2p/monero-0.18.3.4-r1:0/0::guru, ebuild scheduled for merge)</span></span>
<span class="line"><span>  (dev-cpp/abseil-cpp-20250127.1:0/2501.1.0::gentoo, ebuild scheduled for merge) causes rebuilds for:</span></span>
<span class="line"><span>    (media-libs/webrtc-audio-processing-1.3-r3:1/1::gentoo, ebuild scheduled for merge)</span></span>
<span class="line"><span>    (dev-libs/protobuf-30.2:0/30.2.0::gentoo, ebuild scheduled for merge)</span></span>
<span class="line"><span>    (dev-util/android-tools-35.0.2:0/0::gentoo, ebuild scheduled for merge)</span></span>
<span class="line"><span>    (dev-libs/re2-2024.07.02:0/11::gentoo, ebuild scheduled for merge)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>It simply list all package need rebulid for you to get a fuzzy thought about how much time current update will take.</p><p>If everything is OK, type &quot;yes&quot; to comfirm update!</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>Would you like to merge these packages? [Yes/No]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Wait a little bit of time, make sure emerge is doing things correct,then have a <em>good sleep!</em> If anything goes wrong, it will skip it, if no major error such as compiler or system level stuff, you can fix that easly, i may write more tutorial about those common error.</p><h2 id="part-two-kernel-upgrade" tabindex="-1"><a class="header-anchor" href="#part-two-kernel-upgrade"><span>Part Two Kernel upgrade</span></a></h2><p>I only install local compile kernel, this is safer and much customizable, make the OS more fast, flex and hacky.</p><h3 id="check-avaiable-kernel-version" tabindex="-1"><a class="header-anchor" href="#check-avaiable-kernel-version"><span>check avaiable kernel version:</span></a></h3><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">equery</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> meta</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> gentoo-sources</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>You will see a list of all avaliable version of gentoo official kernel(source code version).</p><h3 id="install-kernel-source-code" tabindex="-1"><a class="header-anchor" href="#install-kernel-source-code"><span>install kernel source code</span></a></h3><p>If you want to use stable kernel (above equery command text color for your architectrue is green), you can use this command to install:</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">emerge</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =sys-kernel/gentoo-sources-6.15.8</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Or if you want to try newest, untested kernel, you can bravly choice version from masked stuff! ( above equery command text color four your architectrue is blue). And install using this set of command:</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">emerge</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =sys-kernel/gentoo-sources-6.15.8</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --autounmask</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --autounmask-write</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">dispatch-conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Let me expain, first &quot;--autounmask..&quot; afterfix is allow portage auto create a patch for portage configuraton for automatic unmask package you want to install. Then you can use_dispatch-conf_ to apply it:</p><blockquote><p>info dispatch-conf is designed to be run after merging new packages in order to see if there are updates to the configuration files. If a new configuration file will overwrite an old one, dispatch-conf will prompt the user for a decision about how to resolve the discrepancy. Advantages of dispatch-conf include easy rollback (changes to config files are stored either using patches or rcs) and the ability to automatically update config files that the user has never modified or that differ from the current version only in CVS cruft or white space.</p></blockquote><p>When package is unmasked, you able to install by running above emerge command again:</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">emerge</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> =sys-kernel/gentoo-sources-6.15.8</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="config-kernel" tabindex="-1"><a class="header-anchor" href="#config-kernel"><span>config kernel</span></a></h3><p>First we should confirm kernel source code is exist and reconized for Gentoo Linux</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">/u/src</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ❯❯❯</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> eselect</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> kernel</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> list</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Available</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> kernel</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> symlink</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> targets:</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  [</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">   linux-6.1.127-gentoo</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  [</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">2</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">   linux-6.1.129-gentoo</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  [</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">3</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">   linux-6.1.132-gentoo</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  [</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">4</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">   linux-6.12.1-gentoo</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  [</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">5</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">   linux-6.14.3-gentoo</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  [</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">6</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">   linux-6.15.0-gentoo</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> *</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  [</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">7</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">   linux-6.15.8-gentoo</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You can see i am currently on 6.15.0 version(* symbol) and we gonna hand by hand upgrade to 6.15.8, with my customize configuration! So i gona select 6.15.8 kernel</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">eselect</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> kernel</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> set</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 7</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Then, Gentoo gona change the softlink of &quot;/usr/src/linux&quot; to the kernel source-code we select. Second, we able to config the kernel! Jump in to &quot;/usr/src/linux&quot;</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">cd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/src/linux</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Then choice a good kernel configuration tool, i recommand nconfig, menuconfig is too old-school 😃</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">make</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nconfig</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Boom, you able to select what ever kernel function you want to use! You can read the offical linux kernel configuration manual by this link: <a href="https://wiki.gentoo.org/wiki/Kernel/Gentoo_Kernel_Configuration_Guide" target="_blank" rel="noopener noreferrer">gentoo kernel configuration guide</a></p><p>If you don&#39;t want to make any change, you can simply copy your old kernel config! for exsample as we saw above, i use linux-6.15 as previous kernel, so i need copy configuration form that old folder, just like this:</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">cp</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/src/linux-6.15.0-gentoo/.config</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/src/linux</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="compile-kernel" tabindex="-1"><a class="header-anchor" href="#compile-kernel"><span>compile kernel</span></a></h3><p>Good, we need compile kernel! this will take a while...</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">make</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -j(nproc</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Or manual input count of your threads avaliable.</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">make</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -j(THREAD</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> COUNT</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> YOU</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> WANT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Don&#39;t forget install module! it is really easy to forget.</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">make</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> modules_install</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>When kernel and all module is ready, it is time to install it. (it should auto trigger your bootloader or something to auto copy vmlinux and initramfs to your boot partition, if it can do that, recheck the install process about whatever your bootloader is)</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">make</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Fantastic! and finally if you using nvidia graphic card same as me, you should reinstall nvidia-drivers</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">emerge</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> x11-drivers/nvidia-drivers</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Finally, we can reboot the system, and check out your system is broke or not 😃 If someting go wrong, we also should use old backup kernel to diagnostic and fix the problem.</p><h2 id="end" tabindex="-1"><a class="header-anchor" href="#end"><span>End</span></a></h2><p>Yes, the end.</p>`,66)]))}const d=s(n,[["render",l],["__file","index.html.vue"]]),p=JSON.parse('{"path":"/article/bf6rybyj/","title":"My Gentoo Linux Upgrade Guide[dracut+systemdboot]","lang":"en-US","frontmatter":{"tags":["kernel","gentoolinux"],"createTime":"2025/6/17 20:13:06","title":"My Gentoo Linux Upgrade Guide[dracut+systemdboot]","permalink":"/article/bf6rybyj/","description":"My Gentoo Linux Upgrade Guide This Guide include two part, part one is package update, second part is kernel upgrade. Part one is suit for any Gentoo Linux machine, but part two...","head":[["meta",{"property":"og:url","content":"https://ar0m.com/article/bf6rybyj/"}],["meta",{"property":"og:site_name","content":"My Blog"}],["meta",{"property":"og:title","content":"My Gentoo Linux Upgrade Guide[dracut+systemdboot]"}],["meta",{"property":"og:description","content":"My Gentoo Linux Upgrade Guide This Guide include two part, part one is package update, second part is kernel upgrade. Part one is suit for any Gentoo Linux machine, but part two..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-07-30T12:42:24.000Z"}],["meta",{"property":"article:tag","content":"kernel"}],["meta",{"property":"article:tag","content":"gentoolinux"}],["meta",{"property":"article:modified_time","content":"2025-07-30T12:42:24.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"My Gentoo Linux Upgrade Guide[dracut+systemdboot]\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-07-30T12:42:24.000Z\\",\\"author\\":[]}"]]},"headers":[],"readingTime":{"minutes":5.84,"words":1751},"git":{"updatedTime":1753879344000},"autoDesc":true,"filePathRelative":"gentoo/My Gentoo Linux Upgrade Guide[dracut+systemdboot].md","categoryList":[{"id":"365d0f","sort":10001,"name":"gentoo"}]}');export{d as comp,p as data};
